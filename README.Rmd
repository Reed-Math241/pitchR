---
output: github_document
editor_options: 
  chunk_output_type: console
---

<!-- README.md is generated from README.Rmd. Please edit that file -->

<!-- You'll still need to render `README.Rmd` regularly, to keep `README.md` up-to-date. `devtools::build_readme()` is handy for this.  -->

```{r, include = FALSE}
knitr::opts_chunk$set(
  collapse = TRUE,
  comment = "#>",
  fig.path = "man/figures/README-",
  out.width = "100%"
)
```


# pitchR  <img src= "https://github.com/Reed-Math241/pkgGrpq/blob/master/figs/IMG_0175.png" align="right" width=175 />


<!-- badges: start -->
<!-- badges: end -->


The goal of pitchR is to create an accessible dataset with advanced pitcher statistics by season and their corresponding salaries.  This dataset contains statistics from the 2018 thru 2020 seasons.

## Installation

The development version of XXX is available from [GitHub](https://github.com/) with:

``` r
# install.packages("devtools")
devtools::install_github("Reed-Math241/pkgDemo")
```

## About the Data

Data were collected and made available by [Spotrac](https://www.spotrac.com/mlb/payroll/) and the [Savant](https://baseballsavant.mlb.com/statcast_search).

The pitchR package contains one dataset, with data on Pitchers from the 2018-2020 Seasons. 

```{r showdata}
library(pitchR)
data(package = 'pitchR')
``` 

Here is a simplified version of the raw data; see `?pitchR` for more info: 

```{r example-pitchR}
head(pitchR)
```

## Example

You can find these and more code examples for exploring pitchR in `vignette("examples")`.

Penguins are fun to summarize! For example:

```{r example, warning=FALSE, message=FALSE}
library(tidyverse)
pitchR %>% 
  count(year)
pitchR %>% 
  group_by(year) %>% 
  summarize(across(where(is.numeric), mean, na.rm = TRUE))
```

Pitchers are fun to visualize! For example:
```{r mass-flipper, warning = FALSE, message = FALSE, echo = FALSE, out.width='75%', fig.retina=2}
pitcher_velocity <- ggplot(data = pitchR, 
                           aes(x = velocity, 
                               y = spin_rate))+
  geom_point(aes(color = whiffs),
             alpha = 0.4)+
  theme_minimal()+
  scale_color_distiller(direction = -1, palette = "YlGn")+
    labs(title = "Velocity, Spin Rate, and Whiffs",
       subtitle = "Whiffs: Total Number of times a batter swung and whiffed on the player's pitch",
       x = "Velocity (MPH)",
       y = "Spin Rate (Revolutions per Min.)")+
   theme(legend.background = element_rect(fill = "white", color = NA),
        plot.title.position = "plot",
        plot.caption = element_text(hjust = 0, face= "italic"),
        plot.caption.position = "plot")

pitcher_velocity
```

```{r}
pitcher <- pitchR %>%
  group_by(name) %>%
  summarize(ba = mean(ba), xba = mean(xba), salary = mean (salary))

pitcher_woba <- ggplot(data = pitcher,
                       aes(x = ba,
                           y = xba)) +
  geom_point(aes(color = salary)) +
  geom_abline(slope = 1, intercept = 0) +
  theme_minimal()+
  scale_color_distiller(direction = -1, palette = "YlGn") +
    labs(title = "Batting Average vs Expected Batting Average by Pitcher",
       subtitle = "Batting Average: hits/# of at bats, expected values are derived by comparing the exit velocity and launch angle of batted balls against historical outcomes",
       x = "Batting Average",
       y = "Expected Batting Average") +
   theme(legend.background = element_rect(fill = "white", color = NA),
        plot.title.position = "plot",
        plot.caption = element_text(hjust = 0, face= "italic"),
        plot.caption.position = "plot")

pitcher_woba
```








